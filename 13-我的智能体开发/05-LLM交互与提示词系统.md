# 05 - LLMäº¤äº’ä¸æç¤ºè¯ç³»ç»Ÿ

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.1
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-05
> **æœ€åæ›´æ–°**: 2026-01-14
> **è¿ç§»ä¼˜å…ˆçº§**: â­â­â­â­ (é«˜)

---

## ç‰ˆæœ¬æ›´æ–°è¯´æ˜

### v1.1 (2026-01-14)
- æç¤ºè¯æ¨¡å—ä» 7 ä¸ªæ‰©å±•è‡³ 12 ä¸ªï¼ˆä¸å«åŸºç¡€è®¾æ–½å’Œå¤‡ä»½ï¼‰
- æ–°å¢ 6 ä¸ªé«˜çº§åŠŸèƒ½æ¨¡å—ï¼š
  - `parameter_inference_prompts.rs` - åŠ¨æ€å‚æ•°æ¨æ–­
  - `continue_planning_prompts.rs` - ç»§ç»­è§„åˆ’
  - `post_task_evaluation_prompts.rs` - ä»»åŠ¡åè¯„ä¼°
  - `single_step_repair_prompts.rs` - å•æ­¥ä¿®å¤
  - `message_formatter_prompts.rs` - æ¶ˆæ¯æ ¼å¼åŒ–
  - `ai_reporter_prompts.rs` - AIæŠ¥å‘Šå™¨
- æ›´æ–°æç¤ºè¯æ¨¡å—ç»“æ„è¯´æ˜

---

## 1. LLMå®¢æˆ·ç«¯æ¶æ„

### 1.1 å®¢æˆ·ç«¯å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        LLM å®¢æˆ·ç«¯æ¶æ„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 UnifiedLlmClient (ç»Ÿä¸€å®¢æˆ·ç«¯)                 â”‚   â”‚
â”‚  â”‚                 - æ ¹æ®é…ç½®é€‰æ‹©å®ç°                            â”‚   â”‚
â”‚  â”‚                 - æä¾›ç»Ÿä¸€è°ƒç”¨æ¥å£                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚           â”‚                â”‚                â”‚                      â”‚
â”‚           â–¼                â–¼                â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ LlmClient   â”‚  â”‚GrpcLlmClientâ”‚  â”‚LlmClientWithDiscoveryâ”‚        â”‚
â”‚  â”‚ (HTTP)      â”‚  â”‚ (gRPC)      â”‚  â”‚ (ConsulæœåŠ¡å‘ç°)     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 LlmClient Trait

```rust
/// LLMå®¢æˆ·ç«¯traitå®šä¹‰
#[async_trait]
pub trait LlmClient: Send + Sync {
    /// åŒæ­¥è°ƒç”¨LLM
    async fn call(
        &self,
        system_prompt: &str,
        user_prompt: &str,
    ) -> Result<String>;

    /// æµå¼è°ƒç”¨LLM
    async fn call_stream(
        &self,
        system_prompt: &str,
        user_prompt: &str,
    ) -> Result<Pin<Box<dyn Stream<Item = Result<String>> + Send>>>;
}
```

### 1.3 HTTPå®¢æˆ·ç«¯å®ç°

```rust
pub struct LlmClient {
    client: reqwest::Client,
    endpoint: String,
    model: String,
    temperature: f32,
    max_tokens: u32,
    timeout_secs: u64,
}

impl LlmClient {
    pub fn new(config: &LlmConfig) -> Self {
        Self {
            client: reqwest::Client::new(),
            endpoint: config.endpoint.clone(),
            model: config.model.clone(),
            temperature: config.temperature,
            max_tokens: config.max_tokens,
            timeout_secs: config.timeout_secs,
        }
    }

    async fn call(&self, system_prompt: &str, user_prompt: &str) -> Result<String> {
        let request = LlmRequest {
            model: self.model.clone(),
            messages: vec![
                Message { role: "system".to_string(), content: system_prompt.to_string() },
                Message { role: "user".to_string(), content: user_prompt.to_string() },
            ],
            temperature: self.temperature,
            max_tokens: self.max_tokens,
        };

        let response = self.client
            .post(&self.endpoint)
            .json(&request)
            .timeout(Duration::from_secs(self.timeout_secs))
            .send()
            .await?;

        let llm_response: LlmResponse = response.json().await?;
        Ok(llm_response.choices[0].message.content.clone())
    }
}
```

---

## 2. æç¤ºè¯ç³»ç»Ÿæ¶æ„

### 2.1 æç¤ºè¯æ¨¡å—ç»“æ„ (v1.1 æ›´æ–°)

æç¤ºè¯ç³»ç»Ÿä» **7ä¸ªæ¨¡å—æ‰©å±•è‡³12ä¸ªä¸»æ¨¡å—**ï¼ŒæŒ‰åŠŸèƒ½åˆ†ä¸ºå››å±‚ï¼š

```
src/llm/
â”œâ”€â”€ ğŸ”§ åŸºç¡€è®¾æ–½å±‚ (4ä¸ªæ¨¡å—)
â”‚   â”œâ”€â”€ prompts.rs                        # æç¤ºè¯ç»Ÿä¸€å…¥å£ (re-export)
â”‚   â”œâ”€â”€ message_templates.rs              # ç”¨æˆ·æ¶ˆæ¯æ¨¡æ¿ï¼ˆæ‰§è¡Œæµç¨‹å¯è§†åŒ–ï¼‰
â”‚   â”œâ”€â”€ scene_guidance.rs                 # åœºæ™¯ç®¡ç†æ ¸å¿ƒï¼ˆè¯­ä¹‰è·¯ç”±ï¼‰
â”‚   â””â”€â”€ ai_reporter_prompts.rs            # AIæŠ¥å‘Šå™¨ï¼ˆé€šç”¨è¾“å‡ºç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ ğŸ“‹ è§„åˆ’é˜¶æ®µ (3ä¸ªæ¨¡å—)
â”‚   â”œâ”€â”€ selection_prompts.rs              # å·¥å…·ç­›é€‰æç¤ºè¯ï¼ˆç¬¬ä¸€é˜¶æ®µï¼‰
â”‚   â”œâ”€â”€ planning_prompts.rs               # ä»»åŠ¡è§„åˆ’æç¤ºè¯ï¼ˆç¬¬äºŒé˜¶æ®µï¼‰
â”‚   â””â”€â”€ continue_planning_prompts.rs      # ç»§ç»­è§„åˆ’æç¤ºè¯ï¼ˆä¸­æ–­åç»§ç»­ï¼‰â­ v1.1æ–°å¢
â”‚
â”œâ”€â”€ ğŸ”„ æ‰§è¡Œä¸æ¢å¤é˜¶æ®µ (5ä¸ªæ¨¡å—)
â”‚   â”œâ”€â”€ evaluation_prompts.rs             # æ‰§è¡Œè¯„ä¼°æç¤ºè¯ï¼ˆæ­¥éª¤åè¯„ä¼°ï¼‰
â”‚   â”œâ”€â”€ reflection_prompts.rs             # åæ€æç¤ºè¯ï¼ˆå¤±è´¥åˆ†æï¼‰
â”‚   â”œâ”€â”€ replanning_prompts.rs             # é‡æ–°è§„åˆ’æç¤ºè¯ï¼ˆä»»åŠ¡çº§æ¢å¤ï¼‰
â”‚   â”œâ”€â”€ single_step_repair_prompts.rs     # å•æ­¥ä¿®å¤æç¤ºè¯ï¼ˆæ­¥éª¤çº§æ¢å¤ï¼‰â­ v1.1æ–°å¢
â”‚   â””â”€â”€ parameter_inference_prompts.rs    # åŠ¨æ€å‚æ•°æ¨æ–­æç¤ºè¯ â­ v1.1æ–°å¢
â”‚
â”œâ”€â”€ ğŸ“Š æ€»ç»“ä¸è¾“å‡ºé˜¶æ®µ (2ä¸ªæ¨¡å—)
â”‚   â”œâ”€â”€ post_task_evaluation_prompts.rs   # ä»»åŠ¡åè¯„ä¼°æç¤ºè¯ï¼ˆç»éªŒæç‚¼ï¼‰â­ v1.1æ–°å¢
â”‚   â””â”€â”€ message_formatter_prompts.rs      # æ¶ˆæ¯æ ¼å¼åŒ–æç¤ºè¯ï¼ˆç”¨æˆ·å‹å¥½è¾“å‡ºï¼‰â­ v1.1æ–°å¢
â”‚
â””â”€â”€ ğŸ“š å†å²ç‰ˆæœ¬å¤‡ä»½
    â””â”€â”€ prompts_backup/                   # æç¤ºè¯ç‰ˆæœ¬å†å²
        â”œâ”€â”€ v1/                           # ç¬¬ä¸€ç‰ˆå¤‡ä»½
        â””â”€â”€ v2/                           # ç¬¬äºŒç‰ˆå¤‡ä»½
```

**æ¨¡å—ç»Ÿè®¡**:
- åŸºç¡€è®¾æ–½å±‚ï¼š4ä¸ªæ¨¡å—ï¼ˆé€šç”¨èƒ½åŠ›ï¼‰
- è§„åˆ’é˜¶æ®µï¼š3ä¸ªæ¨¡å—ï¼ˆå«ç»§ç»­è§„åˆ’ï¼‰
- æ‰§è¡Œä¸æ¢å¤ï¼š5ä¸ªæ¨¡å—ï¼ˆå«å•æ­¥ä¿®å¤ã€å‚æ•°æ¨æ–­ï¼‰
- æ€»ç»“ä¸è¾“å‡ºï¼š2ä¸ªæ¨¡å—ï¼ˆä»»åŠ¡åè¯„ä¼°ã€æ¶ˆæ¯æ ¼å¼åŒ–ï¼‰
- **æ€»è®¡**ï¼š**12ä¸ªä¸»æ¨¡å—** + 2ä¸ªç‰ˆæœ¬å¤‡ä»½ç›®å½•

### 2.2 æç¤ºè¯ç»„æˆ

æ¯ä¸ªé˜¶æ®µçš„æç¤ºè¯ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          æç¤ºè¯ç»“æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ System Prompt (ç³»ç»Ÿæç¤ºè¯)                                   â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚ - è§’è‰²å®šä½                                                  â”‚   â”‚
â”‚  â”‚ - æ ¸å¿ƒèŒè´£                                                  â”‚   â”‚
â”‚  â”‚ - è¾“å‡ºæ ¼å¼è¦æ±‚                                              â”‚   â”‚
â”‚  â”‚ - JSON Schema                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ User Prompt (ç”¨æˆ·æç¤ºè¯)                                     â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚ - ä»»åŠ¡æè¿°: {task_description}                              â”‚   â”‚
â”‚  â”‚ - å¯ç”¨å·¥å…·: {available_tools}                               â”‚   â”‚
â”‚  â”‚ - å…ƒæ•°æ®: {metadata}                                        â”‚   â”‚
â”‚  â”‚ - å†å²ä¸Šä¸‹æ–‡: {context}                                     â”‚   â”‚
â”‚  â”‚ - åœºæ™¯æŒ‡å¯¼: {scene_guidance}  â† åŠ¨æ€æ³¨å…¥                    â”‚   â”‚
â”‚  â”‚ - å…¶ä»–å˜é‡...                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. å„é˜¶æ®µæç¤ºè¯è¯¦è§£

### 3.1 å·¥å…·ç­›é€‰é˜¶æ®µ (Selection)

**æ–‡ä»¶**: `selection_prompts.rs`

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä»»åŠ¡è§„åˆ’ä¸“å®¶ï¼Œè´Ÿè´£ä»å·¥å…·åˆ—è¡¨ä¸­ç­›é€‰ä¸ä»»åŠ¡ç›¸å…³çš„å·¥å…·ã€‚

æ ¸å¿ƒèŒè´£:
1. åˆ†æä»»åŠ¡æè¿°ï¼Œç†è§£ä»»åŠ¡æ„å›¾
2. è¯†åˆ«ä»»åŠ¡ç±»å‹ï¼ˆè‡ªç„¶è¯­è¨€å»ºæ¨¡ã€å·¥å…·ç®¡ç†ã€PLCæ§åˆ¶å™¨ç­‰ï¼‰
3. ç­›é€‰ä¸ä»»åŠ¡ç›´æ¥ç›¸å…³çš„å·¥å…·
4. é€‰æ‹©å¯èƒ½åŒ¹é…çš„æ ‡å‡†ä»»åŠ¡æµç¨‹

æ„å›¾è¯†åˆ«ä¼˜å…ˆçº§ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰:
- å¦‚æœä»»åŠ¡æè¿°åŒ…å« "æ„å›¾:" æˆ– "Intent:" æ ‡è®°ï¼Œç›´æ¥ä½¿ç”¨è¯¥æ„å›¾

ç­›é€‰åŸåˆ™:
- å®å¯å¤šé€‰ï¼Œä¸å¯æ¼é€‰
- è€ƒè™‘å®Œæ•´çš„å·¥ä½œæµç¨‹éœ€æ±‚
- ç›¸å…³æ€§è¯„åˆ† >= é˜ˆå€¼çš„å·¥å…·æ‰è¢«é€‰ä¸­

è¾“å‡ºæ ¼å¼:
{
  "selected_tools": ["tool_1", "tool_2", ...],
  "task_type": "è¯†åˆ«çš„ä»»åŠ¡ç±»å‹",
  "workflow_id": "åŒ¹é…çš„æµç¨‹IDï¼ˆå¯é€‰ï¼‰",
  "confidence": 0.85
}
```

**Builderæ–¹æ³•**:
```rust
pub struct SelectionPromptBuilder;

impl SelectionPromptBuilder {
    pub fn build_tool_selection_prompt(
        task_description: &str,
        tools_summary: &str,
        tool_count: usize,
        metadata: &HashMap<String, String>,
        selection_threshold: f32,
        task_type: Option<&str>,
    ) -> (String, String) {
        // 1. è·å–åœºæ™¯æŒ‡å¯¼
        let scene_guidance = SceneManager::new()
            .get_selection_guidance(task_type);

        // 2. æ ¼å¼åŒ–å…ƒæ•°æ®
        let metadata_str = Self::format_metadata(metadata);

        // 3. æ„å»ºç”¨æˆ·æç¤ºè¯
        let user_prompt = SELECTION_USER_TEMPLATE
            .replace("{task_description}", task_description)
            .replace("{tools_summary}", tools_summary)
            .replace("{tool_count}", &tool_count.to_string())
            .replace("{metadata}", &metadata_str)
            .replace("{scene_guidance}", scene_guidance);

        (SELECTION_SYSTEM_PROMPT.to_string(), user_prompt)
    }
}
```

### 3.2 ä»»åŠ¡è§„åˆ’é˜¶æ®µ (Planning)

**æ–‡ä»¶**: `planning_prompts.rs`

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä»»åŠ¡è§„åˆ’ä¸“å®¶ï¼Œè´Ÿè´£å°†ç”¨æˆ·ä»»åŠ¡åˆ†è§£ä¸ºå¯æ‰§è¡Œçš„æ­¥éª¤è®¡åˆ’ã€‚

æ ¸å¿ƒèŒè´£:
1. åˆ†æä»»åŠ¡éœ€æ±‚
2. è®¾è®¡æ‰§è¡Œæ­¥éª¤
3. ç¡®å®šå·¥å…·ä½¿ç”¨
4. è§„åˆ’å‚æ•°ä¼ é€’
5. è€ƒè™‘å¹¶è¡Œæ‰§è¡Œå¯èƒ½æ€§

å¹¶è¡Œæ‰§è¡Œè§„åˆ’:
- åˆ†ææ­¥éª¤é—´çš„æ•°æ®ä¾èµ–
- æ— ä¾èµ–çš„æ­¥éª¤å¯ä»¥å¹¶è¡Œæ‰§è¡Œ
- åœ¨ depends_on å­—æ®µæ ‡æ³¨ä¾èµ–å…³ç³»

Actionsæ ¼å¼è¯´æ˜:
- æ­¥éª¤å¯ä»¥åŒ…å«å¤šä¸ªå­åŠ¨ä½œ
- æ¯ä¸ªåŠ¨ä½œæœ‰ action å’Œ description

è¾“å‡ºJSONæ ¼å¼:
{
  "plan_id": "plan_xxx",
  "plan_description": "è®¡åˆ’æè¿°",
  "steps": [
    {
      "step_id": "step_1",
      "step_name": "æ­¥éª¤åç§°",
      "tool": "tool_id",
      "parameters": {"param1": "value1"},
      "depends_on": [],
      "actions": [
        {"action": "åŠ¨ä½œ", "description": "è¯´æ˜"}
      ]
    }
  ],
  "expected_duration_sec": 300
}
```

**ç”¨æˆ·æç¤ºè¯æ¨¡æ¿**:
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ä»»åŠ¡ä¿¡æ¯ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä»»åŠ¡æè¿°: {task_description}

ä»»åŠ¡å…ƒæ•°æ®:
{metadata}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€å¯ç”¨å·¥å…·ã€‘ï¼ˆå·²ç­›é€‰ï¼Œä¸ä»»åŠ¡é«˜åº¦ç›¸å…³ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{available_tools}

{workflow_hint}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸ ã€åœºæ™¯ä¸“å±è§„åˆ’æŒ‡å¯¼ - æœ€é«˜ä¼˜å…ˆçº§ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{scene_guidance}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€å†å²åæ€ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{reflection_history}

è¯·æ ¹æ®ä»¥ä¸Šä¿¡æ¯ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ã€‚
```

### 3.3 æ‰§è¡Œè¯„ä¼°é˜¶æ®µ (Evaluation)

**æ–‡ä»¶**: `evaluation_prompts.rs`

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä»»åŠ¡è¯„ä¼°ä¸“å®¶ï¼Œè´Ÿè´£è¯„ä¼°ä»»åŠ¡æ‰§è¡Œçš„è´¨é‡å’Œæ•ˆæœã€‚

è¯„ä¼°ç»´åº¦:
1. å®Œæ•´æ€§ (0-100): æ˜¯å¦æ‰§è¡Œäº†æ‰€æœ‰å¿…è¦æ­¥éª¤
2. æ­£ç¡®æ€§ (0-100): æ¯ä¸ªæ­¥éª¤çš„ç»“æœæ˜¯å¦æ­£ç¡®
3. æ•ˆç‡ (0-100): ä»»åŠ¡åˆ†è§£å’Œæ‰§è¡Œé¡ºåºæ˜¯å¦ä¼˜åŒ–
4. å¯é æ€§ (0-100): æ‰§è¡Œè¿‡ç¨‹æ˜¯å¦ç¨³å®š

è¯„ä¼°ä»»åŠ¡:
1. é€æ­¥åˆ†ææ¯ä¸ªæ­¥éª¤çš„æ‰§è¡Œç»“æœ
2. åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æˆåŠŸå®Œæˆ
3. ç»™å‡ºå››ç»´åº¦è¯„åˆ†
4. æä¾›æ”¹è¿›å»ºè®®

è¾“å‡ºæ ¼å¼:
{
  "score": 85,
  "completeness": 90,
  "correctness": 85,
  "efficiency": 80,
  "reliability": 85,
  "is_success": true,
  "needs_reflection": false,
  "summary": "è¯„ä¼°æ‘˜è¦",
  "improvements": ["æ”¹è¿›å»ºè®®1", "æ”¹è¿›å»ºè®®2"]
}
```

### 3.4 åæ€é˜¶æ®µ (Reflection)

**æ–‡ä»¶**: `reflection_prompts.rs`

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä»»åŠ¡åæ€ä¸“å®¶ï¼Œè´Ÿè´£åˆ†ææ­¥éª¤å¤±è´¥çš„æ ¹æœ¬åŸå› å¹¶æä¾›æ”¹è¿›å»ºè®®ã€‚

æ ¸å¿ƒèŒè´£:
1. åˆ†æå¤±è´¥åŸå› 
2. åˆ†ç±»é”™è¯¯ç±»å‹
3. åˆ¤æ–­æ˜¯å¦å¯æ¢å¤
4. æä¾›æ”¹è¿›æ–¹æ¡ˆ
5. å»ºè®®åç»­åŠ¨ä½œ

é”™è¯¯ç±»å‹åˆ†ç±»:
- parameter_error: å‚æ•°é”™è¯¯ï¼ˆå€¼ä¸æ­£ç¡®ã€æ ¼å¼é”™è¯¯ã€ç¼ºå¤±å‚æ•°ï¼‰
- tool_error: å·¥å…·é”™è¯¯ï¼ˆå·¥å…·ä¸å¯ç”¨ã€è¶…æ—¶ã€å†…éƒ¨é”™è¯¯ï¼‰
- dependency_error: ä¾èµ–é”™è¯¯ï¼ˆå‰ç½®æ­¥éª¤å¤±è´¥ã€æ•°æ®ç¼ºå¤±ï¼‰
- decomposition_error: åˆ†è§£é”™è¯¯ï¼ˆæ­¥éª¤è®¾è®¡ä¸åˆç†ã€é—æ¼æ­¥éª¤ï¼‰
- external_error: å¤–éƒ¨é”™è¯¯ï¼ˆç½‘ç»œã€æœåŠ¡ä¸å¯ç”¨ï¼‰

å»ºè®®åŠ¨ä½œ:
- retry_with_adjusted_params: è°ƒæ•´å‚æ•°é‡è¯•
- retry_with_alternative_tool: ä½¿ç”¨å¤‡é€‰å·¥å…·
- repair_single_step: ä¿®å¤å•ä¸ªæ­¥éª¤
- replan_task: é‡æ–°è§„åˆ’æ•´ä¸ªä»»åŠ¡
- abort: ä¸­æ­¢ä»»åŠ¡

è¾“å‡ºæ ¼å¼:
{
  "root_cause_category": "parameter_error",
  "root_cause": "å…·ä½“åŸå› æè¿°",
  "is_recoverable": true,
  "confidence": 0.85,
  "suggested_action": "retry_with_adjusted_params",
  "adjusted_parameters": {"param1": "new_value"},
  "alternative_tool_id": null,
  "improvement_suggestions": ["å»ºè®®1", "å»ºè®®2"]
}
```

### 3.5 é‡æ–°è§„åˆ’é˜¶æ®µ (Replanning)

**æ–‡ä»¶**: `replanning_prompts.rs`

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä»»åŠ¡é‡æ–°è§„åˆ’ä¸“å®¶ï¼Œè´Ÿè´£åŸºäºå¤±è´¥åŸå› ç”Ÿæˆæ–°çš„æ‰§è¡Œè®¡åˆ’ã€‚

æ ¸å¿ƒåŸåˆ™:
1. åˆ†æä¹‹å‰çš„å¤±è´¥åŸå› 
2. ä¿ç•™å·²æˆåŠŸæ‰§è¡Œçš„æ­¥éª¤æˆæœ
3. é¿å…é‡å¤ä¹‹å‰çš„é”™è¯¯
4. è®¾è®¡æ›´åˆç†çš„æ‰§è¡Œè·¯å¾„

å…³é”®çº¦æŸ:
- å¯ä»¥å¼•ç”¨ä¹‹å‰æˆåŠŸæ­¥éª¤çš„è¾“å‡º
- æ–°æ­¥éª¤çš„å‚æ•°å¯ä»¥ä½¿ç”¨å ä½ç¬¦å¼•ç”¨
- è€ƒè™‘å¹¶è¡Œæ‰§è¡Œå¯èƒ½æ€§
- éµå¾ªåœºæ™¯ä¸“å±è§„åˆ™

è¾“å‡ºæ ¼å¼: ä¸è§„åˆ’é˜¶æ®µç›¸åŒçš„JSONæ ¼å¼
```

### 3.6 å•æ­¥ä¿®å¤é˜¶æ®µ (Single Step Repair) â­ v1.1æ–°å¢

**æ–‡ä»¶**: `single_step_repair_prompts.rs`

**åŠŸèƒ½å®šä½**: å½“å•ä¸ªæ­¥éª¤æ‰§è¡Œå¤±è´¥ä½†è¢«åˆ¤å®šä¸ºå¯æ¢å¤æ—¶ï¼Œä½¿ç”¨æ­¤æ¨¡å—ç”Ÿæˆä¿®å¤åçš„æ­¥éª¤å®šä¹‰ã€‚

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ­¥éª¤ä¿®å¤ä¸“å®¶ï¼Œä¸“æ³¨äºä¿®å¤å¤±è´¥çš„ä»»åŠ¡æ­¥éª¤ã€‚

ä½ çš„ä»»åŠ¡æ˜¯åŸºäºç»™å®šçš„å¤±è´¥æ­¥éª¤å’Œé”™è¯¯ä¿¡æ¯ï¼Œæå‡ºä¸€ä¸ªæ”¹è¿›çš„æ­¥éª¤å®šä¹‰ã€‚

é‡è¦åŸåˆ™:
1. åªä¿®å¤å½“å‰æ­¥éª¤ï¼Œä¸æ¶‰åŠå…¶ä»–æ­¥éª¤
2. å°½å¯èƒ½å¤ç”¨åŸæ­¥éª¤çš„é€»è¾‘ï¼Œåªè°ƒæ•´å¿…è¦éƒ¨åˆ†
3. åœ¨å¯ç”¨å·¥å…·åˆ—è¡¨ä¸­é€‰æ‹©æœ€åˆé€‚çš„å·¥å…·
4. è€ƒè™‘é”™è¯¯åŸå› å¹¶æå‡ºé’ˆå¯¹æ€§çš„æ”¹è¿›

ğŸš¨ é¿å…é‡å¤ä¿®å¤ - æå…¶é‡è¦:
- âš ï¸ å¿…é¡»æŸ¥çœ‹æ‰§è¡Œå†å²ï¼šä»”ç»†æ£€æŸ¥æ‰§è¡Œå†å²ä¸­æ˜¯å¦å·²ç»å°è¯•è¿‡ç›¸åŒçš„ä¿®å¤æ–¹æ¡ˆ
- âŒ ç¦æ­¢é‡å¤å¤±è´¥çš„æ–¹æ¡ˆï¼šå¦‚æœå†å²ä¸­æŸä¸ªå·¥å…·æˆ–å‚æ•°ç»„åˆå·²ç»å¤±è´¥è¿‡ï¼Œç»å¯¹ä¸è¦å†æ¬¡ä½¿ç”¨
- âœ… å¯»æ‰¾æ–°çš„è§£å†³æ–¹æ¡ˆï¼šå¿…é¡»æä¾›ä¸å†å²å¤±è´¥å°è¯•ä¸åŒçš„å·¥å…·ã€å‚æ•°æˆ–æ–¹æ³•
- âœ… åˆ†æå¤±è´¥æ¨¡å¼ï¼šä»å†å²å¤±è´¥ä¸­å­¦ä¹ ï¼Œç†è§£ä¸ºä»€ä¹ˆä¹‹å‰çš„æ–¹æ¡ˆä¸å·¥ä½œ

è¾“å‡ºæ ¼å¼:
{
  "step_id": "string (ä¿æŒåŸID)",
  "step_name": "string",
  "tool_id": "string (ä»å¯ç”¨å·¥å…·åˆ—è¡¨ä¸­é€‰æ‹©)",
  "parameters": {"key": "value"},
  "dependencies": ["step_id1", "step_id2"],
  "expected_output": "string",
  "repair_reason": "string (è¯´æ˜è¿™ä¸ªä¿®å¤å¦‚ä½•è§£å†³åŸé—®é¢˜ï¼Œä»¥åŠä¸ºä»€ä¹ˆä¸å†å²å¤±è´¥æ–¹æ¡ˆä¸åŒ)"
}
```

**ä¸åæ€é˜¶æ®µçš„åŒºåˆ«**:
- **åæ€é˜¶æ®µ**: åˆ†æå¤±è´¥åŸå› ï¼Œå†³å®šæ¢å¤ç­–ç•¥ï¼ˆå•æ­¥ä¿®å¤ vs ä»»åŠ¡é‡è§„åˆ’ï¼‰
- **å•æ­¥ä¿®å¤**: å…·ä½“å®æ–½å•æ­¥ä¿®å¤ï¼Œç”Ÿæˆæ–°çš„æ­¥éª¤å®šä¹‰
- **å…³ç³»**: åæ€é˜¶æ®µå»ºè®® `repair_single_step` â†’ å•æ­¥ä¿®å¤é˜¶æ®µæ‰§è¡Œ

**å…³è”æ–‡æ¡£**: [19-åŠ¨æ€å‚æ•°æ¨æ–­åŠŸèƒ½.md](./19-åŠ¨æ€å‚æ•°æ¨æ–­åŠŸèƒ½.md)

### 3.7 åŠ¨æ€å‚æ•°æ¨æ–­é˜¶æ®µ (Parameter Inference) â­ v1.1æ–°å¢

**æ–‡ä»¶**: `parameter_inference_prompts.rs`

**åŠŸèƒ½å®šä½**: å¯é€‰çš„é«˜çº§åŠŸèƒ½ï¼Œåœ¨æ‰§è¡Œæ—¶é€šè¿‡LLMåŠ¨æ€æ¨æ–­æ­¥éª¤å‚æ•°ã€‚

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯å‚æ•°æ¨æ–­ä¸“å®¶ï¼Œæ ¹æ®æ‰§è¡Œå†å²å’Œä¸Šä¸‹æ–‡ä¸ºå½“å‰æ­¥éª¤æ¨æ–­æœ€åˆé€‚çš„å‚æ•°å€¼ã€‚

æ ¸å¿ƒèŒè´£:
1. åˆ†æå½“å‰æ­¥éª¤çš„å·¥å…·å®šä¹‰å’Œå‚æ•°è¦æ±‚
2. ä»æ‰§è¡Œå†å²ä¸­æå–ç›¸å…³è¾“å‡ºæ•°æ®
3. æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­å‚æ•°çš„æœ€ä¼˜å€¼
4. ç¡®ä¿å‚æ•°æ ¼å¼ç¬¦åˆå·¥å…·è¦æ±‚

æ¨æ–­åŸåˆ™:
- ä¼˜å…ˆä»æ‰§è¡Œå†å²çš„è¾“å‡ºä¸­æå–å‚æ•°å€¼
- è€ƒè™‘æ­¥éª¤é—´çš„æ•°æ®ä¾èµ–å…³ç³»
- ä¿è¯å‚æ•°ç±»å‹å’Œæ ¼å¼æ­£ç¡®
- æä¾›æ¨æ–­ç†ç”±å’Œç½®ä¿¡åº¦

è¾“å‡ºæ ¼å¼:
{
  "inferred_parameters": {
    "param1": "value1",
    "param2": "value2"
  },
  "inference_reasoning": "æ¨æ–­ç†ç”±",
  "confidence": 0.85,
  "used_history_steps": ["step_1", "step_3"]
}
```

**ä½¿ç”¨åœºæ™¯**:
- æ­¥éª¤è®¡åˆ’ä¸­çš„å‚æ•°ä¸ºå ä½ç¬¦æˆ–ä¸å®Œæ•´
- å‚æ•°å€¼ä¾èµ–å‰åºæ­¥éª¤çš„è¾“å‡º
- éœ€è¦æ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€å†³å®šå‚æ•°å€¼

**Fallbackæœºåˆ¶**:
- å¦‚æœLLMæ¨æ–­å¤±è´¥ï¼Œå›é€€åˆ°é™æ€å‚æ•°è§£æ
- å¦‚æœå‚æ•°åœ¨è®¡åˆ’ä¸­å·²æ˜ç¡®å®šä¹‰ï¼Œç›´æ¥ä½¿ç”¨é™æ€å€¼

**å…³è”æ–‡æ¡£**: è¯¦ç»†å®ç°è§ [19-åŠ¨æ€å‚æ•°æ¨æ–­åŠŸèƒ½.md](./19-åŠ¨æ€å‚æ•°æ¨æ–­åŠŸèƒ½.md)

### 3.8 ç»§ç»­è§„åˆ’é˜¶æ®µ (Continue Planning) â­ v1.1æ–°å¢

**æ–‡ä»¶**: `continue_planning_prompts.rs`

**åŠŸèƒ½å®šä½**: æ”¯æŒä»»åŠ¡ä¸­æ–­ååŸºäºå†å²æ‰§è¡Œæµç¨‹çš„æ™ºèƒ½ç»§ç»­è§„åˆ’ã€‚

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ç»§ç»­è§„åˆ’ä¸“å®¶ï¼Œè´Ÿè´£åœ¨ä»»åŠ¡ä¸­æ–­ååˆ†æå†å²æ‰§è¡Œæƒ…å†µå¹¶ç”Ÿæˆåç»­è®¡åˆ’ã€‚

æ ¸å¿ƒèŒè´£:
1. åˆ†æå†å²æ‰§è¡Œæµç¨‹ï¼Œè¯†åˆ«å·²å®Œæˆçš„æ­¥éª¤
2. åˆ¤æ–­æœ€åä¸€ä¸ªæ­¥éª¤çš„æ‰§è¡ŒçŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
3. ç†è§£ä»»åŠ¡çš„æ•´ä½“ç›®æ ‡å’Œå½“å‰è¿›åº¦
4. ç”Ÿæˆåˆç†çš„åç»­æ‰§è¡Œè®¡åˆ’

è§„åˆ’åŸåˆ™:
- ä¿ç•™å·²æˆåŠŸæ‰§è¡Œçš„æ­¥éª¤æˆæœ
- åŸºäºæœ€åä¸€ä¸ªæ­¥éª¤çŠ¶æ€å†³å®šç»§ç»­ç­–ç•¥ï¼š
  - å¦‚æœæœ€åæ­¥éª¤æˆåŠŸï¼šç»§ç»­æ‰§è¡Œåç»­æ­¥éª¤
  - å¦‚æœæœ€åæ­¥éª¤å¤±è´¥ï¼šå…ˆä¿®å¤å¤±è´¥æ­¥éª¤ï¼Œå†ç»§ç»­
- è€ƒè™‘å†å²å¤±è´¥æ•™è®­ï¼Œé¿å…é‡å¤é”™è¯¯
- éµå¾ªåœºæ™¯ä¸“å±è§„åˆ™

è¾“å‡ºæ ¼å¼: ä¸è§„åˆ’é˜¶æ®µç›¸åŒçš„JSONæ ¼å¼
```

**æ•°æ®ç»“æ„**:
```rust
pub struct ContinuePlanningContext {
    pub task_type: Option<String>,          // ä»»åŠ¡ç±»å‹
    pub user_context: String,               // å®Œæ•´ä¸Šä¸‹æ–‡ï¼ˆå«å†å²æ‰§è¡Œä¿¡æ¯ï¼‰
}

pub struct HistoricalStep {
    pub step_name: String,
    pub step_id: String,
    pub tool_id: String,
    pub parameters: String,
    pub output: String,
    pub status: String,                      // æˆåŠŸ/å¤±è´¥
    pub timestamp: Option<String>,
}
```

**ä½¿ç”¨åœºæ™¯**:
- ä»»åŠ¡æ‰§è¡Œè¢«æ‰‹åŠ¨ä¸­æ–­
- ç³»ç»Ÿå´©æºƒåæ¢å¤
- åˆ†é˜¶æ®µæ‰§è¡Œé•¿ä»»åŠ¡

### 3.9 ä»»åŠ¡åè¯„ä¼°é˜¶æ®µ (Post-Task Evaluation) â­ v1.1æ–°å¢

**æ–‡ä»¶**: `post_task_evaluation_prompts.rs`

**åŠŸèƒ½å®šä½**: åœ¨ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä»å…¨å±€è§†è§’è¯„ä¼°æ•´ä¸ªä»»åŠ¡å¹¶æå–å¯å¤ç”¨ç»éªŒã€‚

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä»»åŠ¡æ‰§è¡Œç»éªŒæç‚¼ä¸“å®¶ï¼Œä¸“æ³¨äºä»å·²å®Œæˆä»»åŠ¡ä¸­æå–æœ€æœ‰ä»·å€¼çš„ä¸€æ¡ç»éªŒã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘
ä»æœ¬æ¬¡ä»»åŠ¡æ‰§è¡Œä¸­æç‚¼å‡ºå”¯ä¸€ä¸€æ¡æœ€æ ¸å¿ƒã€æœ€æœ‰æŒ‡å¯¼æ„ä¹‰çš„ç»éªŒï¼Œ
å¯ä»¥æ˜¯è§£å†³æ€è·¯æˆ–åæ€å»ºè®®ã€‚

ã€å…³é”®è¦æ±‚ã€‘
âš ï¸ åªç”Ÿæˆ1æ¡ç»éªŒ - ä¸è¦è´ªå¤šï¼Œåªé€‰æœ€çªå‡ºã€æœ€æœ‰æ•ˆçš„é‚£ä¸€æ¡
âš ï¸ è´¨é‡ä¼˜äºæ•°é‡ - å®å¯ä¸€æ¡ç²¾åï¼Œä¸è¦ä¸‰æ¡å‡‘æ•°

ã€ç»éªŒæç‚¼åŸåˆ™ã€‘
ğŸ“Œ å…·ä½“åŒ–åŸåˆ™:
- ä¸è¦ç¬¼ç»Ÿçš„æè¿°ï¼Œè¦å…·ä½“åˆ°"åšä»€ä¹ˆ"ã€"æ€ä¹ˆåš"ã€"ä¸ºä»€ä¹ˆè¿™æ ·åš"
- ç»éªŒå¿…é¡»å¯ä»¥ç›´æ¥ç†è§£å’Œåº”ç”¨ï¼Œè€Œééœ€è¦å†æ¬¡æ€è€ƒ

ğŸ“Œ åœºæ™¯ç»‘å®šåŸåˆ™:
- æ¯æ¡ç»éªŒå¿…é¡»ç»‘å®šå…·ä½“çš„ä»»åŠ¡å’Œæ„å›¾
- æ˜ç¡®è¯´æ˜åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä½¿ç”¨ä»€ä¹ˆæ–¹æ³•

ğŸ“Œ ä»·å€¼ä¼˜å…ˆåŸåˆ™:
- solving_ideasï¼ˆè§£å†³æ€è·¯ï¼‰ï¼šå½“ä»»åŠ¡æˆåŠŸæˆ–æ‰¾åˆ°æœ‰æ•ˆæ–¹æ³•æ—¶é€‰æ‹©
- reflection_suggestionsï¼ˆåæ€å»ºè®®ï¼‰ï¼šå½“ä»»åŠ¡å¤±è´¥æˆ–å‘ç°ç³»ç»Ÿæ€§é—®é¢˜æ—¶é€‰æ‹©

è¾“å‡ºæ ¼å¼:
{
  "task_intent": "ä»»åŠ¡æ„å›¾",
  "experience_type": "solving_ideas",  // æˆ– "reflection_suggestions"
  "experience_content": "å…·ä½“ç»éªŒå†…å®¹",
  "applicable_scenarios": ["åœºæ™¯1", "åœºæ™¯2"]
}
```

**è¯„ä¼°ç»´åº¦**:
- ä»å…¨å±€è§†è§’è¯„ä¼°æ•´ä¸ªä»»åŠ¡çš„æ‰§è¡Œè´¨é‡
- æå–å¯å¤ç”¨çš„æˆåŠŸæ¨¡å¼å’Œå¤±è´¥æ•™è®­
- åˆ†æä»»åŠ¡åˆ†è§£ç­–ç•¥çš„åˆç†æ€§
- è¯„ä¼°å·¥å…·é€‰æ‹©çš„é€‚é…æ€§

**ä¸æ‰§è¡Œè¯„ä¼°çš„åŒºåˆ«**:
- **æ‰§è¡Œè¯„ä¼°** (`evaluation_prompts.rs`): æ­¥éª¤çº§è¯„ä¼°ï¼Œåˆ¤æ–­å•ä¸ªæ­¥éª¤æ˜¯å¦æˆåŠŸ
- **ä»»åŠ¡åè¯„ä¼°** (`post_task_evaluation_prompts.rs`): ä»»åŠ¡çº§è¯„ä¼°ï¼Œæå–å…¨å±€ç»éªŒ

### 3.10 æ¶ˆæ¯æ ¼å¼åŒ–é˜¶æ®µ (Message Formatting) â­ v1.1æ–°å¢

**æ–‡ä»¶**: `message_formatter_prompts.rs`

**åŠŸèƒ½å®šä½**: ç”Ÿæˆç”¨æˆ·å‹å¥½çš„è¿›åº¦æŠ¥å‘Šå’Œæ¶ˆæ¯è¾“å‡ºã€‚

**ç³»ç»Ÿæç¤ºè¯æ ¸å¿ƒå†…å®¹**:
```
ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½ä»»åŠ¡åŠ©æ‰‹ï¼Œæ­£åœ¨ä¸ºç”¨æˆ·æ‰§è¡Œä»»åŠ¡ã€‚è¯·ç”Ÿæˆä¸€ä¸ªç®€æ´çš„è¿›åº¦æŠ¥å‘Šã€‚
```

**ç”¨æˆ·æç¤ºè¯æ¨¡æ¿**:
```
ä»»åŠ¡æ€»ä½“ä¿¡æ¯ï¼š
- ä»»åŠ¡æè¿°ï¼š{task_description}
- æ€»æ­¥éª¤æ•°ï¼š{total_steps}
- å·²å®Œæˆæ­¥éª¤æ•°ï¼š{completed_step_index}
- å‰©ä½™æ­¥éª¤æ•°ï¼š{remaining_steps}

åˆšå®Œæˆçš„æ­¥éª¤ï¼š{last_step_name}

è¯·ç”Ÿæˆä¸€ä¸ªç®€æ´ã€è‡ªç„¶çš„è¿›åº¦æŠ¥å‘Šï¼Œè¦æ±‚ï¼š
1. ç”¨1å¥è¯è¯´æ˜åˆšå®Œæˆäº†ä»€ä¹ˆï¼Œå½“å‰å®Œæˆåº¦
2. å¦‚æœè¿˜æœ‰å‰©ä½™æ­¥éª¤ï¼Œç®€è¦æåŠæ¥ä¸‹æ¥è¦åšä»€ä¹ˆ
3. è¯­æ°”è¦ç§¯æã€é¼“åŠ±ï¼Œä½¿ç”¨"å¤ªå¥½äº†"ã€"å®Œç¾"ç­‰è¯æ±‡
4. ä¸è¦ä½¿ç”¨æŠ€æœ¯æœ¯è¯­ï¼Œç”¨ç®€å•æ˜“æ‡‚çš„è¯­è¨€
5. å­—æ•°æ§åˆ¶åœ¨40å­—ä»¥å†…ï¼Œç›´æ¥è¾“å‡ºè¿›åº¦æŠ¥å‘Šï¼Œä¸è¦æœ‰å…¶ä»–å†…å®¹

ç¤ºä¾‹æ ¼å¼ï¼š
"å¤ªå¥½äº†ï¼Œã€Œæ­¥éª¤åã€æˆåŠŸå®Œæˆï¼ˆX/æ€»æ•°ï¼‰ï¼Œæ¥ä¸‹æ¥æˆ‘å°†ä¸ºæ‚¨å®Œæˆã€Œä¸‹ä¸€æ­¥éª¤ã€"
```

**ä½¿ç”¨åœºæ™¯**:
- æ­¥éª¤æ‰§è¡ŒæˆåŠŸåçš„è¿›åº¦é€šçŸ¥
- ä»»åŠ¡å®Œæˆåçš„æ€»ç»“æ¶ˆæ¯
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

### 3.11 AIæŠ¥å‘Šå™¨ (AI Reporter) â­ v1.1æ–°å¢

**æ–‡ä»¶**: `ai_reporter_prompts.rs`

**åŠŸèƒ½å®šä½**: é€šç”¨çš„è¾“å‡ºç”Ÿæˆå™¨ï¼Œç”¨äºä»»åŠ¡ç¼–æ’åŠ©æ‰‹çš„å„ç±»è¾“å‡ºã€‚

**ç³»ç»Ÿæç¤ºè¯**:
```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä»»åŠ¡ç¼–æ’åŠ©æ‰‹ã€‚è¯·ä¸¥æ ¼æŒ‰ç…§è¦æ±‚ç”Ÿæˆè¾“å‡ºï¼Œä¸è¦æ·»åŠ é¢å¤–çš„è§£é‡Šæˆ–å‰ç¼€ã€‚
```

**ç‰¹ç‚¹**:
- æç®€è®¾è®¡ï¼Œåªæœ‰ç³»ç»Ÿæç¤ºè¯
- ä½œä¸ºåŸºç¡€èƒ½åŠ›è¢«å…¶ä»–æ¨¡å—è°ƒç”¨
- ç¡®ä¿è¾“å‡ºæ ¼å¼çš„ç»Ÿä¸€æ€§å’Œè§„èŒƒæ€§

---

## 4. è¯­ä¹‰è·¯ç”±ä¸åœºæ™¯ç®¡ç†

### 4.1 SceneType æšä¸¾

```rust
#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash)]
pub enum SceneType {
    NaturalLanguageModeling,  // è‡ªç„¶è¯­è¨€å»ºæ¨¡
    ToolManagement,           // å·¥å…·ç®¡ç†
    PlcController,            // PLCæ§åˆ¶å™¨
    ClientManagement,         // å®¢æˆ·ç«¯ç®¡ç†
    General,                  // é€šç”¨åœºæ™¯
}

impl SceneType {
    /// è¿”å›åœºæ™¯ä¸»åç§°
    pub fn primary_name(&self) -> &'static str {
        match self {
            Self::NaturalLanguageModeling => "è‡ªç„¶è¯­è¨€å»ºæ¨¡",
            Self::ToolManagement => "å·¥å…·ç®¡ç†",
            Self::PlcController => "PLCæ§åˆ¶å™¨",
            Self::ClientManagement => "å®¢æˆ·ç«¯ç®¡ç†",
            Self::General => "é€šç”¨",
        }
    }

    /// è¿”å›åœºæ™¯åˆ«ååˆ—è¡¨
    pub fn aliases(&self) -> Vec<&'static str> {
        match self {
            Self::NaturalLanguageModeling => vec![
                "è‡ªç„¶è¯­è¨€å»ºæ¨¡", "è‡ªåŠ¨å»ºæ¨¡", "å»ºæ¨¡", "modeling",
                "ä»¿çœŸ", "æ‹“æ‰‘", "æ•°å­—å­ªç”Ÿ",
            ],
            Self::ToolManagement => vec![
                "å·¥å…·ç®¡ç†", "ä»£ç ç”Ÿæˆ", "å·¥å…·", "tool_management",
                "tool management", "åˆ›å»ºå·¥å…·",
            ],
            Self::PlcController => vec![
                "plc", "æ§åˆ¶å™¨", "controller", "è®¾å¤‡",
                "plcæ§åˆ¶å™¨", "plc controller",
            ],
            Self::ClientManagement => vec![
                "å®¢æˆ·ç«¯", "è§’è‰²", "role", "ç”¨æˆ·", "æƒé™",
            ],
            Self::General => vec!["é€šç”¨", "general", "default"],
        }
    }

    /// è¿”å›æ¨¡ç³ŠåŒ¹é…å…³é”®è¯
    pub fn keywords(&self) -> Vec<&'static str> {
        match self {
            Self::NaturalLanguageModeling => vec!["å»ºæ¨¡", "ä»¿çœŸ", "æ‹“æ‰‘"],
            Self::ToolManagement => vec!["å·¥å…·", "ä»£ç ", "ç”Ÿæˆ"],
            Self::PlcController => vec!["plc", "æ§åˆ¶å™¨", "è®¾å¤‡"],
            Self::ClientManagement => vec!["å®¢æˆ·ç«¯", "è§’è‰²", "ç”¨æˆ·"],
            Self::General => vec![],
        }
    }
}
```

### 4.2 SceneGuidance ç»“æ„

```rust
/// åœºæ™¯æŒ‡å¯¼ç»“æ„ï¼ŒåŒ…å«å…­ä¸ªé˜¶æ®µçš„æŒ‡å¯¼å†…å®¹
pub struct SceneGuidance {
    pub selection_guidance: &'static str,     // å·¥å…·ç­›é€‰é˜¶æ®µ
    pub planning_guidance: &'static str,      // è§„åˆ’é˜¶æ®µ
    pub evaluation_guidance: &'static str,    // è¯„ä¼°é˜¶æ®µ
    pub reflection_guidance: &'static str,    // åæ€é˜¶æ®µ
    pub replanning_guidance: &'static str,    // é‡è§„åˆ’é˜¶æ®µ
    pub message_guidance: &'static str,       // æ¶ˆæ¯ç”Ÿæˆé˜¶æ®µ
}
```

### 4.3 SceneManager å®ç°

```rust
pub struct SceneManager {
    alias_map: HashMap<String, SceneType>,
}

impl SceneManager {
    pub fn new() -> Self {
        let mut alias_map = HashMap::new();

        // æ³¨å†Œæ‰€æœ‰åœºæ™¯çš„åˆ«å
        for scene_type in [
            SceneType::NaturalLanguageModeling,
            SceneType::ToolManagement,
            SceneType::PlcController,
            SceneType::ClientManagement,
            SceneType::General,
        ] {
            for alias in scene_type.aliases() {
                alias_map.insert(alias.to_lowercase(), scene_type);
            }
        }

        Self { alias_map }
    }

    /// åŒ¹é…åœºæ™¯ç±»å‹
    pub fn match_scene(&self, task_type: Option<&str>) -> SceneType {
        let task_type_lower = task_type
            .map(|s| s.to_lowercase())
            .unwrap_or_else(|| "é€šç”¨".to_string());

        // 1. ç²¾ç¡®åŒ¹é…åˆ«å
        if let Some(&scene_type) = self.alias_map.get(&task_type_lower) {
            return scene_type;
        }

        // 2. æ¨¡ç³ŠåŒ¹é…å…³é”®è¯
        for scene_type in [
            SceneType::NaturalLanguageModeling,
            SceneType::ToolManagement,
            SceneType::PlcController,
            SceneType::ClientManagement,
        ] {
            for keyword in scene_type.keywords() {
                let keyword_lower = keyword.to_lowercase();
                if task_type_lower.contains(&keyword_lower)
                    || keyword_lower.contains(&task_type_lower)
                {
                    return scene_type;
                }
            }
        }

        // 3. é»˜è®¤è¿”å›é€šç”¨åœºæ™¯
        SceneType::General
    }

    /// è·å–è§„åˆ’é˜¶æ®µæŒ‡å¯¼
    pub fn get_planning_guidance(&self, task_type: Option<&str>) -> &'static str {
        let scene_type = self.match_scene(task_type);
        self.get_scene_guidance(scene_type).planning_guidance
    }

    /// è·å–åæ€é˜¶æ®µæŒ‡å¯¼
    pub fn get_reflection_guidance(&self, task_type: Option<&str>) -> &'static str {
        let scene_type = self.match_scene(task_type);
        self.get_scene_guidance(scene_type).reflection_guidance
    }

    // å…¶ä»– get_xxx_guidance æ–¹æ³•ç±»ä¼¼...

    fn get_scene_guidance(&self, scene_type: SceneType) -> &SceneGuidance {
        match scene_type {
            SceneType::NaturalLanguageModeling => &NATURAL_LANGUAGE_MODELING_GUIDANCE,
            SceneType::ToolManagement => &TOOL_MANAGEMENT_GUIDANCE,
            SceneType::PlcController => &PLC_CONTROLLER_GUIDANCE,
            SceneType::ClientManagement => &CLIENT_MANAGEMENT_GUIDANCE,
            SceneType::General => &GENERAL_GUIDANCE,
        }
    }
}
```

### 4.4 åœºæ™¯æŒ‡å¯¼ç¤ºä¾‹ (å·¥å…·ç®¡ç†)

```rust
const TOOL_MANAGEMENT_GUIDANCE: SceneGuidance = SceneGuidance {
    selection_guidance: r#"
âš ï¸ **å·¥å…·ç®¡ç†ä»»åŠ¡çš„ç­›é€‰è¦ç‚¹**
- âœ… ä¼˜å…ˆé€‰æ‹© tool_management åˆ†ç±»çš„å·¥å…·
- âœ… å…³æ³¨å·¥å…·è®¾è®¡ã€ä»£ç ç”Ÿæˆç›¸å…³çš„å·¥å…·
- âŒ æ’é™¤ä¸å·¥å…·ç®¡ç†æ— å…³çš„ä¸šåŠ¡å·¥å…·
"#,

    planning_guidance: r#"
âš ï¸ **åˆ›å»ºå·¥å…·çš„ç‰¹æ®Šè§„åˆ™ - æå…¶é‡è¦**
å½“ä»»åŠ¡æ˜¯"åˆ›å»ºå·¥å…·"ã€"ç”Ÿæˆå·¥å…·"ã€"è®¾è®¡å·¥å…·"ç­‰æ—¶:
- âŒ ç¦æ­¢: ç¼–å†™ä»£ç 
- âŒ ç¦æ­¢: æ‰§è¡Œå®ç°æ­¥éª¤
- âœ… åªéœ€: ç”Ÿæˆ"å·¥å…·è®¾è®¡æ–¹æ¡ˆ"çš„å•ä¸ªæ­¥éª¤

**åŸå› è¯´æ˜**: åˆ›å»ºå·¥å…·éœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤è®¾è®¡æ–¹æ¡ˆåæ‰èƒ½å®æ–½
1. åªè§„åˆ’ä¸€ä¸ªæ­¥éª¤: ç”Ÿæˆå·¥å…·è®¾è®¡æ–¹æ¡ˆ
2. ç­‰å¾…ç”¨æˆ·ç¡®è®¤: æ–¹æ¡ˆç”Ÿæˆåéœ€è¦å®¡æ ¸æ‰¹å‡†
3. åç»­å®æ–½: ç¡®è®¤åç”±ç”¨æˆ·å‘èµ·æ–°ä»»åŠ¡
"#,

    evaluation_guidance: r#"
âš ï¸ **å·¥å…·ç®¡ç†ä»»åŠ¡çš„è¯„ä¼°è¦ç‚¹**
- é‡ç‚¹è¯„ä¼°å·¥å…·è®¾è®¡æ–¹æ¡ˆçš„å®Œæ•´æ€§å’Œå¯è¡Œæ€§
- æ£€æŸ¥æ˜¯å¦åŒ…å«å¿…è¦å…ƒç´ (åç§°ã€åŠŸèƒ½ã€å‚æ•°ã€è¾“å‡º)
- å¦‚æœæ˜¯æ–¹æ¡ˆç”Ÿæˆä»»åŠ¡,æˆåŠŸç”Ÿæˆæ–¹æ¡ˆå³è§†ä¸ºå®Œæˆ
"#,

    reflection_guidance: r#"
âš ï¸ **ç‰¹æ®Šåœºæ™¯å¤„ç†(ä¼˜å…ˆåˆ¤æ–­)**:
- å¦‚æœé”™è¯¯ä¿¡æ¯æ˜¯ "æ‰¾ä¸åˆ° tool_id å¯¹åº”çš„å·¥å…·"
  â†’ è¿™è¡¨ç¤ºéœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤æ–¹æ¡ˆé€‰æ‹©
  â†’ **ç»“è®º**: æ— éœ€å•æ­¥åæ€ä¹Ÿæ— éœ€é‡æ–°è§„åˆ’
  â†’ åæ€ç»“æœä¸ºæç¤ºç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤ä½¿ç”¨å“ªä¸ªç”Ÿæˆçš„æ–¹æ¡ˆå³å¯
"#,

    replanning_guidance: "",

    message_guidance: r#"
âš ï¸ **å·¥å…·ç®¡ç†ä»»åŠ¡çš„æ¶ˆæ¯ç”Ÿæˆè¦ç‚¹**
- æ¸…æ™°è¯´æ˜å·¥å…·è®¾è®¡æ–¹æ¡ˆå·²ç”Ÿæˆ
- æé†’ç”¨æˆ·éœ€è¦ç¡®è®¤æ–¹æ¡ˆåæ‰èƒ½å®æ–½
- é¿å…ä½¿ç”¨è¿‡äºæŠ€æœ¯åŒ–çš„æœ¯è¯­
"#,
};
```

---

## 5. æ„å›¾æå–æœºåˆ¶

### 5.1 æ„å›¾æ ‡è®°æ ¼å¼

æ”¯æŒçš„æ ¼å¼ï¼š
- `æ„å›¾: XXX, ç”¨æˆ·è¾“å…¥: YYY`
- `æ„å›¾: XXX, ç”¨æˆ·è¾“å…¥: YYY`
- `Intent: XXX, user_input: YYY`

### 5.2 æå–å®ç°

```rust
/// ä»ä»»åŠ¡æè¿°ä¸­æå–æ„å›¾
fn extract_intent_from_task(task_description: &str) -> Option<String> {
    let patterns = ["æ„å›¾:", "æ„å›¾:", "Intent:", "Intent:"];

    for pattern in &patterns {
        if let Some(start_pos) = task_description.find(pattern) {
            let after_colon = &task_description[start_pos + pattern.len()..];

            // æå–åˆ°ç¬¬ä¸€ä¸ªåˆ†éš”ç¬¦ä¹‹å‰çš„å†…å®¹
            let intent = after_colon
                .split(&[',', 'ï¼Œ', '\n'][..])
                .next()
                .map(|s| s.trim().to_string())?;

            if !intent.is_empty() {
                return Some(intent);
            }
        }
    }
    None
}
```

### 5.3 ä½¿ç”¨åœºæ™¯

```rust
// åœ¨ Planner::plan() ä¸­ä½¿ç”¨
let intent = extract_intent_from_task(task_description);

// å¦‚æœæå–åˆ°æ„å›¾ï¼Œç›´æ¥ä½¿ç”¨ï¼›å¦åˆ™ç”±LLMåœ¨å·¥å…·ç­›é€‰é˜¶æ®µè¯†åˆ«
let task_type = intent.or_else(|| {
    // ä»å·¥å…·ç­›é€‰ç»“æœä¸­è·å– task_type
});
```

---

## 6. æ ‡å‡†å·¥ä½œæµåŒ¹é…

### 6.1 TaskWorkflowManager

```rust
pub struct TaskWorkflowManager {
    workflows: Arc<HashMap<String, TaskWorkflow>>,
}

impl TaskWorkflowManager {
    /// ä»é…ç½®æ–‡ä»¶åŠ è½½å·¥ä½œæµ
    pub fn from_file(config_path: &str) -> Result<Self> {
        let content = std::fs::read_to_string(config_path)?;
        let config: WorkflowsConfig = toml::from_str(&content)?;
        Ok(Self {
            workflows: Arc::new(config.workflows),
        })
    }

    /// æ ¹æ®IDè·å–å·¥ä½œæµ
    pub fn get_workflow(&self, workflow_id: &str) -> Option<TaskWorkflow> {
        self.workflows.get(workflow_id).cloned()
    }

    /// æ ¼å¼åŒ–æ‰€æœ‰å·¥ä½œæµæ‘˜è¦ï¼ˆç”¨äºLLMç­›é€‰ï¼‰
    pub fn format_workflows_summary(&self) -> String {
        let mut summary = String::new();
        for (i, (id, workflow)) in self.workflows.iter().enumerate() {
            summary.push_str(&format!(
                "{}. ID: {} | åç§°: {} | æè¿°: {}\n",
                i + 1, id, workflow.name, workflow.description
            ));
        }
        summary
    }
}
```

### 6.2 å·¥ä½œæµé…ç½®æ–‡ä»¶

```toml
# config/task_workflows.toml

[workflows.load_prediction]
name = "è´Ÿè·é¢„æµ‹"
description = "è´Ÿè·é¢„æµ‹å®Œæ•´æµç¨‹ï¼ŒåŒ…å«æ•°æ®å‡†å¤‡ã€é¢„å¤„ç†ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹è®­ç»ƒå’Œé¢„æµ‹"
keywords = ["è´Ÿè·é¢„æµ‹", "é¢„æµ‹", "load prediction"]
steps = [
    { name = "æ ¡éªŒCSVæ–‡ä»¶", tool_id = "check_csv_file", description = "æ ¡éªŒCSVæ–‡ä»¶æ ¼å¼" },
    { name = "æ³¨å†Œæ•°æ®æº", tool_id = "add_datasource", description = "æ³¨å†Œæ•°æ®æºåˆ°ç³»ç»Ÿ" },
    { name = "ä¸Šä¼ æ•°æ®", tool_id = "data_upload", description = "ä¸Šä¼ æ•°æ®åˆ°æ•°æ®æº" },
    { name = "è·å–æ•°æ®", tool_id = "get_data", description = "ä»æ•°æ®æºè·å–æ•°æ®" },
    # ... æ›´å¤šæ­¥éª¤
]
notes = """
é‡è¦æé†’ï¼š
1. æ­¥éª¤é¡ºåºå¿…é¡»ä¸¥æ ¼éµå®ˆï¼Œå­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»
2. weather_data å¯ä»¥å¹¶è¡Œæ‰§è¡Œ
"""

[workflows.auto_modeling]
name = "è‡ªåŠ¨å»ºæ¨¡"
description = "è‡ªåŠ¨å»ºæ¨¡æµç¨‹..."
# ...
```

---

## 7. è¿ç§»æ£€æŸ¥é¡¹

### 7.1 LLMå®¢æˆ·ç«¯
- [ ] å®ç° LlmClient trait
- [ ] HTTPå®¢æˆ·ç«¯å®ç°
- [ ] gRPCå®¢æˆ·ç«¯å®ç°ï¼ˆå¯é€‰ï¼‰
- [ ] ç»Ÿä¸€å®¢æˆ·ç«¯å°è£…
- [ ] è¶…æ—¶å¤„ç†
- [ ] é”™è¯¯å¤„ç†

### 7.2 æç¤ºè¯æ¨¡å—

#### åŸºç¡€è®¾æ–½å±‚
- [ ] åŸºç¡€æç¤ºè¯æ¨¡å— (prompts.rs)
- [ ] æ¶ˆæ¯æ¨¡æ¿ (message_templates.rs)
- [ ] åœºæ™¯æŒ‡å¯¼ (scene_guidance.rs)
- [ ] AIæŠ¥å‘Šå™¨ (ai_reporter_prompts.rs) â­ v1.1

#### è§„åˆ’é˜¶æ®µ
- [ ] å·¥å…·ç­›é€‰æç¤ºè¯ (selection_prompts.rs)
- [ ] è§„åˆ’æç¤ºè¯ (planning_prompts.rs)
- [ ] ç»§ç»­è§„åˆ’æç¤ºè¯ (continue_planning_prompts.rs) â­ v1.1

#### æ‰§è¡Œä¸æ¢å¤é˜¶æ®µ
- [ ] è¯„ä¼°æç¤ºè¯ (evaluation_prompts.rs)
- [ ] åæ€æç¤ºè¯ (reflection_prompts.rs)
- [ ] é‡è§„åˆ’æç¤ºè¯ (replanning_prompts.rs)
- [ ] å•æ­¥ä¿®å¤æç¤ºè¯ (single_step_repair_prompts.rs) â­ v1.1
- [ ] åŠ¨æ€å‚æ•°æ¨æ–­æç¤ºè¯ (parameter_inference_prompts.rs) â­ v1.1

#### æ€»ç»“ä¸è¾“å‡ºé˜¶æ®µ
- [ ] ä»»åŠ¡åè¯„ä¼°æç¤ºè¯ (post_task_evaluation_prompts.rs) â­ v1.1
- [ ] æ¶ˆæ¯æ ¼å¼åŒ–æç¤ºè¯ (message_formatter_prompts.rs) â­ v1.1

### 7.3 åœºæ™¯ç®¡ç†
- [ ] SceneType æšä¸¾
- [ ] SceneGuidance ç»“æ„
- [ ] SceneManager å®ç°
- [ ] å„åœºæ™¯æŒ‡å¯¼å†…å®¹
- [ ] æ„å›¾æå–å‡½æ•°

### 7.4 å·¥ä½œæµç®¡ç†
- [ ] TaskWorkflow ç»“æ„
- [ ] TaskWorkflowManager å®ç°
- [ ] é…ç½®æ–‡ä»¶åŠ è½½
- [ ] å·¥ä½œæµåŒ¹é…é€»è¾‘

---

## ä¸‹ä¸€æ­¥

### æ¨èé˜…è¯»é¡ºåº

1. **æ ¸å¿ƒæ¢å¤æœºåˆ¶**: é˜…è¯» [06-åæ€ä¸é‡è§„åˆ’æœºåˆ¶.md](./06-åæ€ä¸é‡è§„åˆ’æœºåˆ¶.md) äº†è§£å®¹é”™æ¢å¤æœºåˆ¶çš„è¯¦ç»†å®ç°
2. **é«˜çº§ç‰¹æ€§** (v1.1æ–°å¢):
   - [17-Plan-with-Filesæ¨¡å¼.md](./17-Plan-with-Filesæ¨¡å¼.md) - æ‰§è¡Œå†å²ä½œä¸ºå•ä¸€çœŸç†æ¥æº
   - [18-ç§»é™¤è½®æ•°é™åˆ¶æœºåˆ¶.md](./18-ç§»é™¤è½®æ•°é™åˆ¶æœºåˆ¶.md) - æ™ºèƒ½è½®æ•°ç®¡ç†
   - [19-åŠ¨æ€å‚æ•°æ¨æ–­åŠŸèƒ½.md](./19-åŠ¨æ€å‚æ•°æ¨æ–­åŠŸèƒ½.md) - LLMè¿è¡Œæ—¶å‚æ•°ç”Ÿæˆ

### ç›¸å…³æ–‡æ¡£

- [02-æ ¸å¿ƒæ¶æ„è®¾è®¡.md](./02-æ ¸å¿ƒæ¶æ„è®¾è®¡.md) - ç³»ç»Ÿæ¶æ„æ€»è§ˆ
- [03-è§„åˆ’ç³»ç»Ÿ.md](./03-è§„åˆ’ç³»ç»Ÿ.md) - è§„åˆ’ç³»ç»Ÿè¯¦è§£
