# 19 - åŠ¨æ€å‚æ•°æ¨æ–­åŠŸèƒ½

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-14
> **è¿ç§»ä¼˜å…ˆçº§**: â­â­â­ (ä¸­)

---

## 1. æ¦‚è¿°

### 1.1 åŠŸèƒ½å®šä½

åŠ¨æ€å‚æ•°æ¨æ–­æ˜¯ä»»åŠ¡ç¼–æ’æœåŠ¡çš„ä¸€ä¸ª**å¯é€‰å¢å¼ºåŠŸèƒ½**ï¼Œå…è®¸åœ¨æ­¥éª¤æ‰§è¡Œæ—¶è°ƒç”¨å¤§æ¨¡å‹ï¼ˆLLMï¼‰æ ¹æ®å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡åŠ¨æ€ç”Ÿæˆå·¥å…·è°ƒç”¨å‚æ•°ï¼Œè€Œä¸æ˜¯å®Œå…¨ä¾èµ–è§„åˆ’é˜¶æ®µç¡®å®šçš„é™æ€æ§½ä½å‚æ•°ã€‚

### 1.2 è®¾è®¡èƒŒæ™¯

ä¼ ç»Ÿçš„æ§½ä½å‚æ•°æœºåˆ¶åœ¨è§„åˆ’é˜¶æ®µç¡®å®šå‚æ•°ï¼Œé€šè¿‡å ä½ç¬¦ï¼ˆå¦‚ `{{step_id.outputs.field}}`ï¼‰åœ¨æ‰§è¡Œæ—¶è§£æã€‚è¿™ç§æ–¹å¼åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹å·¥ä½œè‰¯å¥½ï¼Œä½†åœ¨ä»¥ä¸‹æƒ…å†µå¯èƒ½ä¸å¤Ÿçµæ´»ï¼š

| åœºæ™¯ | è¯´æ˜ |
|------|------|
| **å¤æ‚çš„å‚æ•°ä¾èµ–** | å½“å‚æ•°éœ€è¦æ ¹æ®å¤šä¸ªå‰ç½®æ­¥éª¤çš„è¾“å‡ºç»¼åˆåˆ¤æ–­æ—¶ |
| **æ¡ä»¶æ€§å‚æ•°** | æ ¹æ®æ‰§è¡Œç»“æœåŠ¨æ€è°ƒæ•´åç»­å‚æ•° |
| **ä¸Šä¸‹æ–‡æ„ŸçŸ¥** | éœ€è¦ç†è§£æ‰§è¡Œå†å²æ¥ç¡®å®šæœ€ä½³å‚æ•°å€¼ |

### 1.3 æ ¸å¿ƒåŸåˆ™

| åŸåˆ™ | è¯´æ˜ |
|------|------|
| **å¯é€‰æ€§** | é€šè¿‡é…ç½®å¼€å…³æ§åˆ¶ï¼Œé»˜è®¤å…³é—­ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½ |
| **å‘åå…¼å®¹** | å…³é—­æ—¶å®Œå…¨ä½¿ç”¨åŸæœ‰çš„æ§½ä½å‚æ•°æœºåˆ¶ |
| **å®¹é”™è®¾è®¡** | LLM è°ƒç”¨å¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ°é™æ€å‚æ•°è§£æ |

---

## 2. æ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ­¥éª¤æ‰§è¡Œæµç¨‹                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 1. è¯»å–é…ç½®å¼€å…³       â”‚                                       â”‚
â”‚  â”‚ enable_dynamic_       â”‚                                       â”‚
â”‚  â”‚ parameter_inference   â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚           é…ç½®å¼€å…³åˆ¤æ–­                 â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚             â”‚                                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚     â”‚               â”‚                                           â”‚
â”‚     â–¼               â–¼                                           â”‚
â”‚  å¼€å¯(true)      å…³é—­(false)                                    â”‚
â”‚     â”‚               â”‚                                           â”‚
â”‚     â–¼               â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ è°ƒç”¨LLM   â”‚   â”‚ ParameterResolver â”‚                          â”‚
â”‚  â”‚ åŠ¨æ€æ¨æ–­  â”‚   â”‚ é™æ€è§£æå‚æ•°      â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚       â”‚                   â”‚                                      â”‚
â”‚       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚       â”‚   â”‚                                                      â”‚
â”‚       â–¼   â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 3. è·å–æœ€ç»ˆå‚æ•°        â”‚                                       â”‚
â”‚  â”‚    HashMap<String,    â”‚                                       â”‚
â”‚  â”‚           String>     â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚ 4. æ‰§è¡Œå·¥å…·è°ƒç”¨        â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŠ¨æ€æ¨æ–­è¯¦ç»†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŠ¨æ€å‚æ•°æ¨æ–­æµç¨‹                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. æ„å»ºæ¨æ–­ä¸Šä¸‹æ–‡ (ParameterInferenceContext)              â”‚   â”‚
â”‚  â”‚    - step_id, step_name, step_description                 â”‚   â”‚
â”‚  â”‚    - tool_id, tool_description                            â”‚   â”‚
â”‚  â”‚    - tool_input_params (å·¥å…·è¾“å…¥å‚æ•°å®šä¹‰)                  â”‚   â”‚
â”‚  â”‚    - tool_output_params (å·¥å…·è¾“å‡ºå‚æ•°å®šä¹‰)                 â”‚   â”‚
â”‚  â”‚    - metadata (ä»»åŠ¡å…ƒæ•°æ®)                                 â”‚   â”‚
â”‚  â”‚    - execution_history (å·²å®Œæˆæ­¥éª¤çš„æ‰§è¡Œå†å²)              â”‚   â”‚
â”‚  â”‚    - planned_parameters (è§„åˆ’é˜¶æ®µçš„å‚æ•°å‚è€ƒ)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2. æ„å»ºæç¤ºè¯                                              â”‚   â”‚
â”‚  â”‚    - System Prompt: å‚æ•°æ¨æ–­ä¸“å®¶è§’è‰²è®¾å®š                   â”‚   â”‚
â”‚  â”‚    - User Prompt: åŒ…å«ä¸Šä¸‹æ–‡çš„å‚æ•°æ¨æ–­è¯·æ±‚                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 3. è°ƒç”¨ LLM                                                â”‚   â”‚
â”‚  â”‚    llm_client.call(system_prompt, user_prompt)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 4. è§£æ LLM å“åº”                                           â”‚   â”‚
â”‚  â”‚    - æå– JSON å†…å®¹                                        â”‚   â”‚
â”‚  â”‚    - è§£æä¸º ParameterInferenceResult                      â”‚   â”‚
â”‚  â”‚    - è½¬æ¢ä¸º HashMap<String, String>                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 5. è¿”å›æ¨æ–­ç»“æœ                                            â”‚   â”‚
â”‚  â”‚    - æˆåŠŸ: è¿”å›æ¨æ–­å‡ºçš„å‚æ•°                                â”‚   â”‚
â”‚  â”‚    - å¤±è´¥: å›é€€åˆ°é™æ€å‚æ•°è§£æ                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. æ ¸å¿ƒæ•°æ®ç»“æ„

### 3.1 ParameterInferenceContext (å‚æ•°æ¨æ–­ä¸Šä¸‹æ–‡)

```rust
#[derive(Debug, Clone)]
pub struct ParameterInferenceContext {
    pub step_id: String,           // æ­¥éª¤ID
    pub step_name: String,         // æ­¥éª¤åç§°
    pub step_description: String,  // æ­¥éª¤æè¿°
    pub tool_id: String,           // å·¥å…·ID
    pub tool_description: String,  // å·¥å…·æè¿°
    pub tool_input_params: String, // å·¥å…·è¾“å…¥å‚æ•°å®šä¹‰ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
    pub tool_output_params: String,// å·¥å…·è¾“å‡ºå‚æ•°å®šä¹‰ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
    pub metadata: HashMap<String, String>,  // ä»»åŠ¡å…ƒæ•°æ®
    pub execution_history: Vec<StepExecutionRecord>,  // æ‰§è¡Œå†å²
    pub planned_parameters: String,  // è§„åˆ’é˜¶æ®µçš„å‚æ•°
}
```

### 3.2 StepExecutionRecord (æ­¥éª¤æ‰§è¡Œè®°å½•)

```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct StepExecutionRecord {
    pub step_id: String,
    pub step_name: String,
    pub tool_id: String,
    pub is_success: bool,
    pub output: String,
    pub parameters: HashMap<String, String>,
}
```

### 3.3 ParameterInferenceResult (å‚æ•°æ¨æ–­ç»“æœ)

```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct ParameterInferenceResult {
    pub parameters: HashMap<String, serde_json::Value>,
    pub reasoning: String,
}
```

---

## 4. æç¤ºè¯ç³»ç»Ÿ

### 4.1 ç³»ç»Ÿæç¤ºè¯

```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å·¥å…·å‚æ•°æ¨æ–­ä¸“å®¶...

## æ ¸å¿ƒåŸåˆ™
1. **ç²¾ç¡®æ€§**ï¼šå‚æ•°å€¼å¿…é¡»å®Œå…¨åŒ¹é…å·¥å…·çš„è¾“å…¥å‚æ•°å®šä¹‰
2. **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šå……åˆ†åˆ©ç”¨å·²æ‰§è¡Œæ­¥éª¤çš„è¾“å‡ºå’Œå…ƒæ•°æ®
3. **ç±»å‹æ­£ç¡®**ï¼šç¡®ä¿å‚æ•°ç±»å‹ä¸å·¥å…·å®šä¹‰ä¸€è‡´
4. **æœ€å°å¿…è¦**ï¼šåªç”Ÿæˆå¿…éœ€çš„å‚æ•°

## å‚æ•°æ¥æºä¼˜å…ˆçº§
1. **å‰ç½®æ­¥éª¤è¾“å‡º**ï¼šä¼˜å…ˆä»å·²å®Œæˆæ­¥éª¤çš„è¾“å‡ºä¸­æå–å‚æ•°
2. **ä»»åŠ¡å…ƒæ•°æ®**ï¼šä»ä»»åŠ¡åˆå§‹åŒ–æ—¶ä¼ å…¥çš„ metadata ä¸­è·å–
3. **å·¥å…·é»˜è®¤å€¼**ï¼šå½“å·¥å…·å®šä¹‰äº†é»˜è®¤å€¼ä¸”æ— å…¶ä»–æ¥æºæ—¶ä½¿ç”¨
4. **åˆç†æ¨æ–­**ï¼šä»…åœ¨æœ‰è¶³å¤Ÿä¸Šä¸‹æ–‡æ”¯æ’‘æ—¶è¿›è¡Œæ¨æ–­

## è¾“å‡ºæ ¼å¼
{
  "parameters": { ... },
  "reasoning": "ç®€è¦è¯´æ˜å‚æ•°æ¨æ–­çš„ä¾æ®"
}
```

### 4.2 ç”¨æˆ·æç¤ºè¯æ¨¡æ¿

```
è¯·ä¸ºä»¥ä¸‹æ­¥éª¤æ¨æ–­å·¥å…·è°ƒç”¨å‚æ•°ã€‚

## å½“å‰æ­¥éª¤ä¿¡æ¯
- **æ­¥éª¤ID**: {step_id}
- **æ­¥éª¤åç§°**: {step_name}
- **æ­¥éª¤æè¿°**: {step_description}
- **è°ƒç”¨å·¥å…·**: {tool_id}

## å·¥å…·ä¿¡æ¯
### å·¥å…·æè¿°
{tool_description}

### è¾“å…¥å‚æ•°å®šä¹‰
{tool_input_params}

### è¾“å‡ºå‚æ•°å®šä¹‰
{tool_output_params}

## æ‰§è¡Œä¸Šä¸‹æ–‡
### ä»»åŠ¡å…ƒæ•°æ® (Metadata)
{metadata}

### å·²å®Œæˆæ­¥éª¤çš„æ‰§è¡Œå†å²
{execution_history}

## è§„åˆ’é˜¶æ®µçš„å‚æ•°å‚è€ƒï¼ˆå¯èƒ½åŒ…å«å ä½ç¬¦ï¼‰
{planned_parameters}
```

---

## 5. Executor å®ç°

### 5.1 ç»“æ„ä½“æ–°å¢å­—æ®µ

```rust
pub struct Executor {
    // ... åŸæœ‰å­—æ®µ ...

    // ==================== åŠ¨æ€å‚æ•°æ¨æ–­é…ç½® ====================
    /// æ˜¯å¦å¯ç”¨åŠ¨æ€å‚æ•°æ¨æ–­
    enable_dynamic_parameter_inference: bool,
    /// LLM å®¢æˆ·ç«¯ï¼ˆç”¨äºåŠ¨æ€å‚æ•°æ¨æ–­ï¼‰
    llm_client: Option<UnifiedLlmClient>,
}
```

### 5.2 æ–°å¢æ„é€ å‡½æ•°

```rust
/// åˆ›å»ºæ”¯æŒåŠ¨æ€å‚æ•°æ¨æ–­çš„æ‰§è¡Œå™¨
pub fn new_with_parameter_inference(
    tool_client: Arc<UnifiedToolServiceClient>,
    timeout_secs: u64,
    kafka_logger: Arc<KafkaLogger>,
    enable_parallel: bool,
    parallel_max_concurrent: usize,
    parallel_min_steps: usize,
    enable_dynamic_parameter_inference: bool,
    llm_client: Option<UnifiedLlmClient>,
) -> Self {
    // ... åˆå§‹åŒ–é€»è¾‘ ...
}
```

### 5.3 æ ¸å¿ƒæ–¹æ³•

#### resolve_step_parameters (ç»Ÿä¸€å…¥å£)

```rust
/// è§£ææ­¥éª¤å‚æ•°ï¼ˆæ ¹æ®é…ç½®é€‰æ‹©é™æ€æˆ–åŠ¨æ€æ¨æ–­ï¼‰
pub async fn resolve_step_parameters(
    &self,
    step: &PlanStep,
    tool_info: &ToolInfo,
    context: &ExecutionContext,
    available_tools: &[ToolInfo],
) -> Result<HashMap<String, String>> {
    if self.enable_dynamic_parameter_inference {
        self.infer_parameters_with_llm(step, tool_info, context, available_tools).await
    } else {
        Ok(ParameterResolver::resolve_parameters(step, tool_info, context))
    }
}
```

#### infer_parameters_with_llm (LLMæ¨æ–­)

```rust
/// ä½¿ç”¨ LLM åŠ¨æ€æ¨æ–­æ­¥éª¤å‚æ•°
async fn infer_parameters_with_llm(
    &self,
    step: &PlanStep,
    tool_info: &ToolInfo,
    context: &ExecutionContext,
    available_tools: &[ToolInfo],
) -> Result<HashMap<String, String>> {
    // 1. æ£€æŸ¥ LLM å®¢æˆ·ç«¯
    let llm_client = match &self.llm_client {
        Some(client) => client,
        None => return Ok(ParameterResolver::resolve_parameters(...)),  // å›é€€
    };

    // 2. æ„å»ºæ‰§è¡Œå†å²
    let execution_history = self.build_execution_history(context, available_tools);

    // 3. æ„å»ºæ¨æ–­ä¸Šä¸‹æ–‡
    let inference_context = ParameterInferenceContext { ... };

    // 4. æ„å»ºæç¤ºè¯å¹¶è°ƒç”¨ LLM
    let system_prompt = ParameterInferencePromptBuilder::get_system_prompt();
    let user_prompt = ParameterInferencePromptBuilder::build_user_prompt(&inference_context);

    match llm_client.call(system_prompt, &user_prompt, None).await {
        Ok(response) => {
            match ParameterInferencePromptBuilder::parse_response(&response) {
                Ok(result) => Ok(ParameterInferencePromptBuilder::result_to_string_map(&result)),
                Err(_) => Ok(ParameterResolver::resolve_parameters(...)),  // å›é€€
            }
        }
        Err(_) => Ok(ParameterResolver::resolve_parameters(...)),  // å›é€€
    }
}
```

---

## 6. é…ç½®è¯´æ˜

### 6.1 é…ç½®æ–‡ä»¶

```toml
# config.dev.toml / config.prod.toml / config.local.toml

[debug]
# ==================== åŠ¨æ€å‚æ•°æ¨æ–­é…ç½® ====================
# æ˜¯å¦å¯ç”¨åŠ¨æ€å‚æ•°æ¨æ–­ï¼ˆè¿è¡Œæ—¶è°ƒç”¨LLMç”Ÿæˆå‚æ•°ï¼‰
# - true: æ­¥éª¤æ‰§è¡Œæ—¶è°ƒç”¨LLMæ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€ç”Ÿæˆå‚æ•°
# - false: ä½¿ç”¨è§„åˆ’é˜¶æ®µç¡®å®šçš„æ§½ä½å‚æ•°ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰
enable_dynamic_parameter_inference = false
```

### 6.2 é…ç½®ç»“æ„

```rust
// src/config/mod.rs
#[derive(Debug, Clone, Deserialize, Serialize)]
pub struct DebugConfig {
    // ... å…¶ä»–å­—æ®µ ...

    /// æ˜¯å¦å¯ç”¨åŠ¨æ€å‚æ•°æ¨æ–­ï¼ˆè¿è¡Œæ—¶è°ƒç”¨LLMç”Ÿæˆå‚æ•°ï¼‰
    #[serde(default = "default_enable_dynamic_parameter_inference")]
    pub enable_dynamic_parameter_inference: bool,
}

fn default_enable_dynamic_parameter_inference() -> bool {
    false  // é»˜è®¤å…³é—­
}
```

---

## 7. æ‰§è¡Œæ¨¡å¼æ”¯æŒ

### 7.1 æ”¯æŒæƒ…å†µ

| æ‰§è¡Œæ¨¡å¼ | æ”¯æŒçŠ¶æ€ | è¯´æ˜ |
|---------|---------|------|
| **ä¸²è¡Œæ‰§è¡Œ** (`execute_plan_serial`) | âœ… æ”¯æŒ | æ¯ä¸ªæ­¥éª¤æ‰§è¡Œå‰è°ƒç”¨ LLM æ¨æ–­å‚æ•° |
| **å•æ­¥æ‰§è¡Œ** (`execute_single_step_with_overrides`) | âœ… æ”¯æŒ | ä½¿ç”¨ `resolve_step_parameters` æ–¹æ³• |
| **æ­¥éª¤å†…å¹¶è¡Œæ‰§è¡Œ** (`execute_step_with_actions`) | âœ… æ”¯æŒ | åœ¨å¹¶è¡Œæ‰§è¡Œå‰ç»Ÿä¸€ä¸ºæ‰€æœ‰ actions æ¨æ–­å‚æ•° |
| **DAG å¹¶è¡Œæ‰§è¡Œ** (`ParallelExecutor`) | âŒ ä¸æ”¯æŒ | ä¿æŒä½¿ç”¨é™æ€å‚æ•°è§£æ |

### 7.2 æ­¥éª¤å†…å¹¶è¡Œæ‰§è¡Œçš„ç‰¹æ®Šå¤„ç†

ç”±äºæ­¥éª¤å†…çš„ actions é€šå¸¸è°ƒç”¨åŒä¸€ä¸ªå·¥å…·ï¼Œå®ç°é‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š

1. åœ¨å¹¶è¡Œæ‰§è¡Œä»»åŠ¡å¯åŠ¨å‰ï¼Œ**ä¸²è¡Œ**åœ°ä¸ºæ¯ä¸ª action è°ƒç”¨ LLM æ¨æ–­å‚æ•°
2. å°†æ¨æ–­ç»“æœå­˜å…¥ `HashMap<action_id, HashMap<String, String>>`
3. å¹¶è¡Œæ‰§è¡Œæ—¶ï¼Œå„ä»»åŠ¡ä»é¢„å…ˆæ¨æ–­çš„ç»“æœä¸­è·å–å‚æ•°

```rust
// æ­¥éª¤å†…å¹¶è¡Œæ‰§è¡Œçš„å‚æ•°æ¨æ–­é€»è¾‘
let inferred_params_map: HashMap<String, HashMap<String, String>> =
    if self.enable_dynamic_parameter_inference {
        self.infer_action_parameters(step, context, tool_map).await
    } else {
        HashMap::new()  // ç©º HashMapï¼Œå›é€€åˆ°é™æ€è§£æ
    };
```

---

## 8. ä½¿ç”¨æŒ‡å—

### 8.1 å¯ç”¨åŠ¨æ€å‚æ•°æ¨æ–­

1. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `config.dev.toml`ï¼‰ï¼š

```toml
[debug]
enable_dynamic_parameter_inference = true
```

2. é‡å¯æœåŠ¡

### 8.2 æ—¥å¿—æ ‡è¯†

å¯ç”¨åï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—è§‚å¯ŸåŠ¨æ€å‚æ•°æ¨æ–­çš„æ‰§è¡Œï¼š

```
ğŸ§  å¼€å§‹åŠ¨æ€å‚æ•°æ¨æ–­
âœ… LLM å‚æ•°æ¨æ–­å“åº”å·²æ”¶åˆ°
âœ… åŠ¨æ€å‚æ•°æ¨æ–­æˆåŠŸ
ğŸ§  æ¨æ–­å‡ºçš„å‚æ•°: key=value
```

### 8.3 å›é€€åœºæ™¯

ä»¥ä¸‹æƒ…å†µä¼šè‡ªåŠ¨å›é€€åˆ°é™æ€å‚æ•°è§£æï¼š

| åœºæ™¯ | å›é€€å¤„ç† |
|------|---------|
| LLM å®¢æˆ·ç«¯æœªé…ç½® | ä½¿ç”¨ ParameterResolver é™æ€è§£æ |
| LLM è°ƒç”¨å¤±è´¥ï¼ˆç½‘ç»œã€è¶…æ—¶ç­‰ï¼‰ | å›é€€åˆ°é™æ€è§£æå¹¶è®°å½•è­¦å‘Šæ—¥å¿— |
| LLM å“åº”è§£æå¤±è´¥ | å›é€€åˆ°é™æ€è§£æå¹¶è®°å½•è­¦å‘Šæ—¥å¿— |

---

## 9. é€‚ç”¨åœºæ™¯

### 9.1 æ¨èåœºæ™¯

âœ… **å‚æ•°ä¾èµ–å…³ç³»å¤æ‚**ï¼Œéš¾ä»¥ç”¨ç®€å•å ä½ç¬¦è¡¨è¾¾
âœ… **éœ€è¦æ ¹æ®æ‰§è¡Œç»“æœåŠ¨æ€è°ƒæ•´å‚æ•°**
âœ… **è°ƒè¯•å’Œå¼€å‘é˜¶æ®µ**ï¼Œè§‚å¯Ÿ LLM çš„å‚æ•°ç†è§£èƒ½åŠ›

### 9.2 ä¸æ¨èåœºæ™¯

âŒ **ç”Ÿäº§ç¯å¢ƒç¨³å®šè¿è¡Œæ—¶**ï¼ˆå¢åŠ å»¶è¿Ÿå’Œæˆæœ¬ï¼‰
âŒ **å‚æ•°å…³ç³»ç®€å•æ˜ç¡®æ—¶**
âŒ **å¯¹å“åº”æ—¶é—´è¦æ±‚ä¸¥æ ¼æ—¶**

---

## 10. æ³¨æ„äº‹é¡¹

### 10.1 æ€§èƒ½è€ƒè™‘

- åŠ¨æ€å‚æ•°æ¨æ–­ä¼šå¢åŠ æ¯ä¸ªæ­¥éª¤çš„æ‰§è¡Œæ—¶é—´ï¼ˆLLM è°ƒç”¨å¼€é”€ï¼‰
- å»ºè®®ä»…åœ¨éœ€è¦å¤æ‚å‚æ•°æ¨æ–­çš„åœºæ™¯ä¸‹å¯ç”¨

### 10.2 æˆæœ¬è€ƒè™‘

- æ¯ä¸ªæ­¥éª¤æ‰§è¡Œéƒ½ä¼šè°ƒç”¨ LLM
- å¢åŠ  LLM API è°ƒç”¨æˆæœ¬

### 10.3 å¯é æ€§è€ƒè™‘

- ä¾èµ– LLM æœåŠ¡çš„å¯ç”¨æ€§
- å†…ç½®å›é€€æœºåˆ¶ä¿è¯åŸºæœ¬åŠŸèƒ½ä¸å—å½±å“

---

## 11. è¿ç§»æ£€æŸ¥é¡¹

### 11.1 é…ç½®æ¨¡å—
- [ ] åœ¨ `DebugConfig` ä¸­æ·»åŠ  `enable_dynamic_parameter_inference` å­—æ®µ
- [ ] å®ç°é»˜è®¤å€¼å‡½æ•° `default_enable_dynamic_parameter_inference()`
- [ ] åœ¨æ‰€æœ‰é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®é¡¹è¯´æ˜

### 11.2 æç¤ºè¯æ¨¡å—
- [ ] åˆ›å»º `src/llm/parameter_inference_prompts.rs`
- [ ] å®šä¹‰ `ParameterInferenceContext` ç»“æ„
- [ ] å®šä¹‰ `StepExecutionRecord` ç»“æ„
- [ ] å®šä¹‰ `ParameterInferenceResult` ç»“æ„
- [ ] å®ç° `ParameterInferencePromptBuilder`
- [ ] åœ¨ `src/llm/mod.rs` ä¸­å¯¼å‡ºç›¸å…³ç±»å‹

### 11.3 Executor æ”¹é€ 
- [ ] æ·»åŠ  `enable_dynamic_parameter_inference` å’Œ `llm_client` å­—æ®µ
- [ ] å®ç° `new_with_parameter_inference()` æ„é€ å‡½æ•°
- [ ] å®ç° `resolve_step_parameters()` ç»Ÿä¸€å…¥å£
- [ ] å®ç° `infer_parameters_with_llm()` æ¨æ–­æ–¹æ³•
- [ ] å®ç° `build_execution_history()` è¾…åŠ©æ–¹æ³•
- [ ] å®ç° `infer_action_parameters()` æ–¹æ³•ï¼ˆæ­¥éª¤å†…å¹¶è¡Œï¼‰

### 11.4 å…¥å£æ–‡ä»¶
- [ ] åœ¨ `main.rs` ä¸­æ ¹æ®é…ç½®åˆ›å»º Executor
- [ ] åœ¨ `main_grpc.rs` ä¸­æ ¹æ®é…ç½®åˆ›å»º Executor

---

## ä¸‹ä¸€æ­¥

é˜…è¯» [00-è¿ç§»æ–‡æ¡£ç´¢å¼•.md](./00-è¿ç§»æ–‡æ¡£ç´¢å¼•.md) äº†è§£å®Œæ•´çš„è¿ç§»æ–‡æ¡£ä½“ç³»ã€‚
